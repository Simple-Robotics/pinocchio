//
// Copyright (c) 2025 INRIA
//

#ifndef __pinocchio_math_details_matrix_inversion_7x7_hpp__
#define __pinocchio_math_details_matrix_inversion_7x7_hpp__

#include "pinocchio/math/matrix.hpp"

namespace pinocchio
{
  namespace internal
  {
    template<>
    struct MatrixInversionCodeGeneratedImpl<7>
    {
      template<typename M1, typename M2>
      static EIGEN_STRONG_INLINE void
      run(const Eigen::MatrixBase<M1> & matrix, const Eigen::MatrixBase<M2> & matrix_inverse_)
      {
        typedef typename M1::Scalar Scalar;

        assert(is_symmetric(matrix));

        const auto & input_vec = matrix.reshaped();
        auto & matrix_inverse = matrix_inverse_.const_cast_derived();
        auto output_vec = matrix_inverse.reshaped();

        Scalar a00, a01, a02, a03, a04, a05, a06, a07, a08, a09, a10, a11;
        Scalar a12, a13, a14, a15, a16, a17, a18, a19, a20, a21, a22, a23;
        Scalar a24, a25, a26, a27, a28, a29, a30, a31, a32, a33, a34, a35;
        Scalar a36, a37, a38, a39, a40, a41, a42, a43, a44, a45, a46, a47;
        Scalar a48, a49, a50, a51, a52, a53, a54, a55;
        a00 = input_vec[0];
        a01 = input_vec[7];
        a02 = input_vec[14];
        a03 = input_vec[21];
        a04 = input_vec[28];
        a05 = input_vec[35];
        a06 = input_vec[42];
        a07 = input_vec[48];
        a07 = math::sqrt(a07);
        a06 = (a06 / a07);
        a08 = input_vec[47];
        a08 = (a08 / a07);
        a09 = (a06 * a08);
        a05 = (a05 - a09);
        a09 = input_vec[40];
        a10 = math::square(a08);
        a09 = (a09 - a10);
        a09 = math::sqrt(a09);
        a05 = (a05 / a09);
        a10 = input_vec[39];
        a11 = input_vec[46];
        a11 = (a11 / a07);
        a12 = (a11 * a08);
        a10 = (a10 - a12);
        a10 = (a10 / a09);
        a12 = (a05 * a10);
        a13 = (a06 * a11);
        a12 = (a12 + a13);
        a04 = (a04 - a12);
        a12 = input_vec[32];
        a13 = math::square(a10);
        a14 = math::square(a11);
        a13 = (a13 + a14);
        a12 = (a12 - a13);
        a12 = math::sqrt(a12);
        a04 = (a04 / a12);
        a13 = input_vec[31];
        a14 = input_vec[38];
        a15 = input_vec[45];
        a15 = (a15 / a07);
        a16 = (a15 * a08);
        a14 = (a14 - a16);
        a14 = (a14 / a09);
        a16 = (a14 * a10);
        a17 = (a15 * a11);
        a16 = (a16 + a17);
        a13 = (a13 - a16);
        a13 = (a13 / a12);
        a16 = (a04 * a13);
        a17 = (a05 * a14);
        a16 = (a16 + a17);
        a17 = (a06 * a15);
        a16 = (a16 + a17);
        a03 = (a03 - a16);
        a16 = input_vec[24];
        a17 = math::square(a13);
        a18 = math::square(a14);
        a17 = (a17 + a18);
        a18 = math::square(a15);
        a17 = (a17 + a18);
        a16 = (a16 - a17);
        a16 = math::sqrt(a16);
        a03 = (a03 / a16);
        a17 = input_vec[23];
        a18 = input_vec[30];
        a19 = input_vec[37];
        a20 = input_vec[44];
        a20 = (a20 / a07);
        a21 = (a20 * a08);
        a19 = (a19 - a21);
        a19 = (a19 / a09);
        a21 = (a19 * a10);
        a22 = (a20 * a11);
        a21 = (a21 + a22);
        a18 = (a18 - a21);
        a18 = (a18 / a12);
        a21 = (a18 * a13);
        a22 = (a19 * a14);
        a21 = (a21 + a22);
        a22 = (a20 * a15);
        a21 = (a21 + a22);
        a17 = (a17 - a21);
        a17 = (a17 / a16);
        a21 = (a03 * a17);
        a22 = (a04 * a18);
        a21 = (a21 + a22);
        a22 = (a05 * a19);
        a21 = (a21 + a22);
        a22 = (a06 * a20);
        a21 = (a21 + a22);
        a02 = (a02 - a21);
        a21 = input_vec[16];
        a22 = math::square(a17);
        a23 = math::square(a18);
        a22 = (a22 + a23);
        a23 = math::square(a19);
        a22 = (a22 + a23);
        a23 = math::square(a20);
        a22 = (a22 + a23);
        a21 = (a21 - a22);
        a21 = math::sqrt(a21);
        a02 = (a02 / a21);
        a22 = input_vec[15];
        a23 = input_vec[22];
        a24 = input_vec[29];
        a25 = input_vec[36];
        a26 = input_vec[43];
        a26 = (a26 / a07);
        a27 = (a26 * a08);
        a25 = (a25 - a27);
        a25 = (a25 / a09);
        a27 = (a25 * a10);
        a28 = (a26 * a11);
        a27 = (a27 + a28);
        a24 = (a24 - a27);
        a24 = (a24 / a12);
        a27 = (a24 * a13);
        a28 = (a25 * a14);
        a27 = (a27 + a28);
        a28 = (a26 * a15);
        a27 = (a27 + a28);
        a23 = (a23 - a27);
        a23 = (a23 / a16);
        a27 = (a23 * a17);
        a28 = (a24 * a18);
        a27 = (a27 + a28);
        a28 = (a25 * a19);
        a27 = (a27 + a28);
        a28 = (a26 * a20);
        a27 = (a27 + a28);
        a22 = (a22 - a27);
        a22 = (a22 / a21);
        a27 = (a02 * a22);
        a28 = (a03 * a23);
        a27 = (a27 + a28);
        a28 = (a04 * a24);
        a27 = (a27 + a28);
        a28 = (a05 * a25);
        a27 = (a27 + a28);
        a28 = (a06 * a26);
        a27 = (a27 + a28);
        a01 = (a01 - a27);
        a27 = input_vec[8];
        a28 = math::square(a22);
        a29 = math::square(a23);
        a28 = (a28 + a29);
        a29 = math::square(a24);
        a28 = (a28 + a29);
        a29 = math::square(a25);
        a28 = (a28 + a29);
        a29 = math::square(a26);
        a28 = (a28 + a29);
        a27 = (a27 - a28);
        a27 = math::sqrt(a27);
        a01 = (a01 / a27);
        a28 = math::square(a01);
        a29 = math::square(a02);
        a28 = (a28 + a29);
        a29 = math::square(a03);
        a28 = (a28 + a29);
        a29 = math::square(a04);
        a28 = (a28 + a29);
        a29 = math::square(a05);
        a28 = (a28 + a29);
        a29 = math::square(a06);
        a28 = (a28 + a29);
        a00 = (a00 - a28);
        a00 = math::sqrt(a00);
        a28 = (1. / a00);
        a28 = (a28 / a00);
        output_vec[0] = a28;
        a28 = (a01 / a27);
        a28 = (a28 / a00);
        a28 = (a28 / a00);
        a29 = (-a28);
        output_vec[1] = a29;
        a30 = (a02 / a21);
        a31 = (a22 / a21);
        a31 = (a31 / a27);
        a32 = (a01 * a31);
        a30 = (a30 - a32);
        a30 = (a30 / a00);
        a30 = (a30 / a00);
        a32 = (-a30);
        output_vec[2] = a32;
        a33 = (a03 / a16);
        a34 = (a23 / a16);
        a35 = (a17 / a16);
        a35 = (a35 / a21);
        a36 = (a22 * a35);
        a34 = (a34 - a36);
        a34 = (a34 / a27);
        a36 = (a01 * a34);
        a37 = (a02 * a35);
        a36 = (a36 + a37);
        a33 = (a33 - a36);
        a33 = (a33 / a00);
        a33 = (a33 / a00);
        a36 = (-a33);
        output_vec[3] = a36;
        a37 = (a04 / a12);
        a38 = (a24 / a12);
        a39 = (a18 / a12);
        a40 = (a13 / a12);
        a40 = (a40 / a16);
        a41 = (a17 * a40);
        a39 = (a39 - a41);
        a39 = (a39 / a21);
        a41 = (a22 * a39);
        a42 = (a23 * a40);
        a41 = (a41 + a42);
        a38 = (a38 - a41);
        a38 = (a38 / a27);
        a41 = (a01 * a38);
        a42 = (a02 * a39);
        a41 = (a41 + a42);
        a42 = (a03 * a40);
        a41 = (a41 + a42);
        a37 = (a37 - a41);
        a37 = (a37 / a00);
        a37 = (a37 / a00);
        a41 = (-a37);
        output_vec[4] = a41;
        a42 = (a05 / a09);
        a43 = (a25 / a09);
        a44 = (a19 / a09);
        a45 = (a14 / a09);
        a46 = (a10 / a09);
        a46 = (a46 / a12);
        a47 = (a13 * a46);
        a45 = (a45 - a47);
        a45 = (a45 / a16);
        a47 = (a17 * a45);
        a48 = (a18 * a46);
        a47 = (a47 + a48);
        a44 = (a44 - a47);
        a44 = (a44 / a21);
        a47 = (a22 * a44);
        a48 = (a23 * a45);
        a47 = (a47 + a48);
        a48 = (a24 * a46);
        a47 = (a47 + a48);
        a43 = (a43 - a47);
        a43 = (a43 / a27);
        a47 = (a01 * a43);
        a48 = (a02 * a44);
        a47 = (a47 + a48);
        a48 = (a03 * a45);
        a47 = (a47 + a48);
        a48 = (a04 * a46);
        a47 = (a47 + a48);
        a42 = (a42 - a47);
        a42 = (a42 / a00);
        a42 = (a42 / a00);
        a47 = (-a42);
        output_vec[5] = a47;
        a48 = (a06 / a07);
        a49 = (a26 / a07);
        a50 = (a20 / a07);
        a51 = (a15 / a07);
        a52 = (a11 / a07);
        a53 = (a08 / a07);
        a53 = (a53 / a09);
        a54 = (a10 * a53);
        a52 = (a52 - a54);
        a52 = (a52 / a12);
        a54 = (a13 * a52);
        a55 = (a14 * a53);
        a54 = (a54 + a55);
        a51 = (a51 - a54);
        a51 = (a51 / a16);
        a54 = (a17 * a51);
        a55 = (a18 * a52);
        a54 = (a54 + a55);
        a55 = (a19 * a53);
        a54 = (a54 + a55);
        a50 = (a50 - a54);
        a50 = (a50 / a21);
        a54 = (a22 * a50);
        a55 = (a23 * a51);
        a54 = (a54 + a55);
        a55 = (a24 * a52);
        a54 = (a54 + a55);
        a55 = (a25 * a53);
        a54 = (a54 + a55);
        a49 = (a49 - a54);
        a49 = (a49 / a27);
        a54 = (a01 * a49);
        a55 = (a02 * a50);
        a54 = (a54 + a55);
        a55 = (a03 * a51);
        a54 = (a54 + a55);
        a55 = (a04 * a52);
        a54 = (a54 + a55);
        a55 = (a05 * a53);
        a54 = (a54 + a55);
        a48 = (a48 - a54);
        a48 = (a48 / a00);
        a48 = (a48 / a00);
        a00 = (-a48);
        output_vec[6] = a00;
        output_vec[7] = a29;
        a29 = (1. / a27);
        a28 = (a01 * a28);
        a29 = (a29 + a28);
        a29 = (a29 / a27);
        output_vec[8] = a29;
        a29 = (a01 * a30);
        a29 = (a29 - a31);
        a29 = (a29 / a27);
        output_vec[9] = a29;
        a31 = (a01 * a33);
        a31 = (a31 - a34);
        a31 = (a31 / a27);
        output_vec[10] = a31;
        a34 = (a01 * a37);
        a34 = (a34 - a38);
        a34 = (a34 / a27);
        output_vec[11] = a34;
        a38 = (a01 * a42);
        a38 = (a38 - a43);
        a38 = (a38 / a27);
        output_vec[12] = a38;
        a01 = (a01 * a48);
        a01 = (a01 - a49);
        a01 = (a01 / a27);
        output_vec[13] = a01;
        output_vec[14] = a32;
        output_vec[15] = a29;
        a32 = (1. / a21);
        a29 = (a22 * a29);
        a30 = (a02 * a30);
        a29 = (a29 - a30);
        a32 = (a32 - a29);
        a32 = (a32 / a21);
        output_vec[16] = a32;
        a32 = (a22 * a31);
        a29 = (a02 * a33);
        a32 = (a32 - a29);
        a35 = (a35 + a32);
        a35 = (a35 / a21);
        a32 = (-a35);
        output_vec[17] = a32;
        a29 = (a22 * a34);
        a30 = (a02 * a37);
        a29 = (a29 - a30);
        a39 = (a39 + a29);
        a39 = (a39 / a21);
        a29 = (-a39);
        output_vec[18] = a29;
        a30 = (a22 * a38);
        a27 = (a02 * a42);
        a30 = (a30 - a27);
        a44 = (a44 + a30);
        a44 = (a44 / a21);
        a30 = (-a44);
        output_vec[19] = a30;
        a22 = (a22 * a01);
        a02 = (a02 * a48);
        a22 = (a22 - a02);
        a50 = (a50 + a22);
        a50 = (a50 / a21);
        a21 = (-a50);
        output_vec[20] = a21;
        output_vec[21] = a36;
        output_vec[22] = a31;
        output_vec[23] = a32;
        a32 = (1. / a16);
        a31 = (a23 * a31);
        a33 = (a03 * a33);
        a31 = (a31 - a33);
        a35 = (a17 * a35);
        a31 = (a31 - a35);
        a32 = (a32 - a31);
        a32 = (a32 / a16);
        output_vec[24] = a32;
        a32 = (a23 * a34);
        a31 = (a03 * a37);
        a32 = (a32 - a31);
        a31 = (a17 * a39);
        a32 = (a32 - a31);
        a40 = (a40 + a32);
        a40 = (a40 / a16);
        a32 = (-a40);
        output_vec[25] = a32;
        a31 = (a23 * a38);
        a35 = (a03 * a42);
        a31 = (a31 - a35);
        a35 = (a17 * a44);
        a31 = (a31 - a35);
        a45 = (a45 + a31);
        a45 = (a45 / a16);
        a31 = (-a45);
        output_vec[26] = a31;
        a23 = (a23 * a01);
        a03 = (a03 * a48);
        a23 = (a23 - a03);
        a17 = (a17 * a50);
        a23 = (a23 - a17);
        a51 = (a51 + a23);
        a51 = (a51 / a16);
        a16 = (-a51);
        output_vec[27] = a16;
        output_vec[28] = a41;
        output_vec[29] = a34;
        output_vec[30] = a29;
        output_vec[31] = a32;
        a32 = (1. / a12);
        a34 = (a24 * a34);
        a37 = (a04 * a37);
        a34 = (a34 - a37);
        a39 = (a18 * a39);
        a34 = (a34 - a39);
        a40 = (a13 * a40);
        a34 = (a34 - a40);
        a32 = (a32 - a34);
        a32 = (a32 / a12);
        output_vec[32] = a32;
        a32 = (a24 * a38);
        a34 = (a04 * a42);
        a32 = (a32 - a34);
        a34 = (a18 * a44);
        a32 = (a32 - a34);
        a34 = (a13 * a45);
        a32 = (a32 - a34);
        a46 = (a46 + a32);
        a46 = (a46 / a12);
        a32 = (-a46);
        output_vec[33] = a32;
        a24 = (a24 * a01);
        a04 = (a04 * a48);
        a24 = (a24 - a04);
        a18 = (a18 * a50);
        a24 = (a24 - a18);
        a13 = (a13 * a51);
        a24 = (a24 - a13);
        a52 = (a52 + a24);
        a52 = (a52 / a12);
        a12 = (-a52);
        output_vec[34] = a12;
        output_vec[35] = a47;
        output_vec[36] = a38;
        output_vec[37] = a30;
        output_vec[38] = a31;
        output_vec[39] = a32;
        a32 = (1. / a09);
        a38 = (a25 * a38);
        a42 = (a05 * a42);
        a38 = (a38 - a42);
        a44 = (a19 * a44);
        a38 = (a38 - a44);
        a45 = (a14 * a45);
        a38 = (a38 - a45);
        a46 = (a10 * a46);
        a38 = (a38 - a46);
        a32 = (a32 - a38);
        a32 = (a32 / a09);
        output_vec[40] = a32;
        a25 = (a25 * a01);
        a05 = (a05 * a48);
        a25 = (a25 - a05);
        a19 = (a19 * a50);
        a25 = (a25 - a19);
        a14 = (a14 * a51);
        a25 = (a25 - a14);
        a10 = (a10 * a52);
        a25 = (a25 - a10);
        a53 = (a53 + a25);
        a53 = (a53 / a09);
        a09 = (-a53);
        output_vec[41] = a09;
        output_vec[42] = a00;
        output_vec[43] = a01;
        output_vec[44] = a21;
        output_vec[45] = a16;
        output_vec[46] = a12;
        output_vec[47] = a09;
        a09 = (1. / a07);
        a26 = (a26 * a01);
        a06 = (a06 * a48);
        a26 = (a26 - a06);
        a20 = (a20 * a50);
        a26 = (a26 - a20);
        a15 = (a15 * a51);
        a26 = (a26 - a15);
        a11 = (a11 * a52);
        a26 = (a26 - a11);
        a08 = (a08 * a53);
        a26 = (a26 - a08);
        a09 = (a09 - a26);
        a09 = (a09 / a07);
        output_vec[48] = a09;
      }
    };
  } // namespace internal
} // namespace pinocchio

#endif // ifndef __pinocchio_math_details_matrix_inversion_7x7_hpp__
